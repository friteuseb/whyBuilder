<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhyPro - Générateur de Why d'Entreprise</title>
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #1a365d 0%, #2d3748 50%, #1a202c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2b6cb0 0%, #1a365d 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            font-weight: 300;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.2rem;
            margin-bottom: 25px;
        }

        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 20px;
        }

        .progress-fill {
            background: white;
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 15px;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transition: all 0.3s ease;
        }

        .step-dot.active {
            background: white;
            transform: scale(1.2);
        }

        .step-dot.completed {
            background: #28a745;
        }

        .main-content {
            padding: 50px;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .step-number {
            font-size: 4rem;
            font-weight: 100;
            color: #2b6cb0;
            margin-bottom: 15px;
        }

        .step-title {
            font-size: 2rem;
            color: #2d3748;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .step-subtitle {
            font-size: 1.1rem;
            color: #6c757d;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            border-left: 5px solid #2b6cb0;
            transition: all 0.3s ease;
        }

        .question-card:hover {
            transform: translateX(5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .question {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .answer-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            resize: vertical;
            min-height: 80px;
            transition: border-color 0.3s ease;
        }

        .answer-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .emotion-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .emotion-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .emotion-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
        }

        .emotion-card.selected {
            border-color: #667eea;
            background: #f7faff;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .emotion-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .value-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .value-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .value-card:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .value-card.selected {
            border-color: #667eea;
            background: #f7faff;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .why-result {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-top: 30px;
        }

        .why-statement {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2d3748;
            line-height: 1.4;
            margin-bottom: 20px;
            padding: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }

        .why-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .breakdown-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .breakdown-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }

        .tips-section {
            background: #e3f2fd;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .tips-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1976d2;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tip-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #2196f3;
        }

        .inspiration-quotes {
            margin-top: 40px;
            text-align: center;
        }

        .quote {
            font-style: italic;
            font-size: 1.1rem;
            color: #6c757d;
            margin-bottom: 20px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .timeline {
            position: relative;
            margin: 30px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: linear-gradient(to bottom, #667eea, #764ba2);
            border-radius: 2px;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
            position: relative;
        }

        .timeline-item:nth-child(even) {
            flex-direction: row-reverse;
        }

        .timeline-content {
            flex: 1;
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin: 0 30px;
        }

        .timeline-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            position: relative;
            z-index: 2;
            border: 4px solid white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.2);
        }

        /* Modal styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 700px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }

        .close:hover {
            opacity: 0.7;
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            color: #6c757d;
            font-size: 0.85rem;
        }

        .version-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
            position: relative;
        }

        .version-card h4 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .version-card .why-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .version-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.85rem;
            border-radius: 6px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-section {
            text-align: center;
            padding: 40px 20px;
        }

        .loading-section p {
            color: #6c757d;
            font-size: 1.1rem;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 30px 20px;
            }
            
            .emotion-selector {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .value-grid {
                grid-template-columns: 1fr;
            }
            
            .timeline::before {
                left: 30px;
            }
            
            .timeline-item {
                flex-direction: row !important;
            }
            
            .timeline-content {
                margin-left: 70px;
                margin-right: 0;
            }

            .modal-content {
                width: 95%;
                margin: 5% auto;
            }

            .modal-body {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏢 WhyPro</h1>
            <p>Découvrez la raison d'être de votre entreprise en 7 étapes guidées</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="step-indicator" id="stepIndicator">
                <div class="step-dot active"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
                <div class="step-dot"></div>
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn" onclick="loadTestData()" style="background: #17a2b8; font-size: 0.9rem; padding: 10px 20px;">
                    🧪 Charger des données de test
                </button>
            </div>
        </div>

        <div class="main-content">
            <!-- Étape 1: Introduction -->
            <div class="step active" id="step1">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Bienvenue dans la quête du Why de votre entreprise</div>
                    <div class="step-subtitle">
                        Selon Simon Sinek, "Les gens n'achètent pas ce que vous faites, ils achètent pourquoi vous le faites". 
                        Ensemble, nous allons découvrir la raison d'être profonde de votre organisation.
                    </div>
                </div>

                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-icon">🏢</div>
                        <div class="timeline-content">
                            <h3>L'ADN de votre entreprise</h3>
                            <p>Nous explorerons l'essence même de votre organisation et ce qui la rend unique.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-icon">💡</div>
                        <div class="timeline-content">
                            <h3>Votre mission d'entreprise</h3>
                            <p>Nous analyserons comment vos valeurs se traduisent dans votre activité et vos services.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-icon">🌍</div>
                        <div class="timeline-content">
                            <h3>Votre impact sur le marché</h3>
                            <p>Nous définirons la transformation que votre entreprise apporte à vos clients et à la société.</p>
                        </div>
                    </div>
                </div>

                <div class="tips-section">
                    <div class="tips-title">💡 Conseils pour une découverte authentique</div>
                    <div class="tip-item">
                        <strong>Soyez authentique :</strong> Réfléchissez aux valeurs réelles de votre entreprise, pas à celles que vous aimeriez avoir.
                    </div>
                    <div class="tip-item">
                        <strong>Impliquez l'équipe :</strong> Les meilleures réponses émergent souvent d'une réflexion collective.
                    </div>
                    <div class="tip-item">
                        <strong>Pensez client :</strong> Votre Why doit résonner avec les besoins profonds de vos clients.
                    </div>
                </div>
            </div>

            <!-- Étape 2: Origines de l'entreprise -->
            <div class="step" id="step2">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Les origines de votre entreprise</div>
                    <div class="step-subtitle">
                        Explorons ce qui a motivé la création de votre entreprise et ce qui l'anime aujourd'hui
                    </div>
                </div>

                <div class="question-card">
                    <div class="question">🚀 Rappelez-vous le moment de création de l'entreprise. Quel problème cherchiez-vous à résoudre ?</div>
                    <textarea class="answer-input" id="q2_1" placeholder="Décrivez la frustration ou l'opportunité qui a donné naissance à votre entreprise..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">⚡ Qu'est-ce qui vous irrite le plus dans votre secteur d'activité ?</div>
                    <textarea class="answer-input" id="q2_2" placeholder="Les dysfonctionnements, inefficacités ou problèmes que vous voulez changer..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">🏆 Quel retour client vous a le plus marqué et pourquoi ?</div>
                    <textarea class="answer-input" id="q2_3" placeholder="Un témoignage, remerciement ou reconnaissance qui vous a particulièrement touché..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">💡 Si vous aviez des ressources illimitées, quel serait le projet rêvé de votre entreprise ?</div>
                    <textarea class="answer-input" id="q2_4" placeholder="Imaginez votre vision la plus ambitieuse sans contraintes..."></textarea>
                </div>
            </div>

            <!-- Étape 3: Valeurs fondamentales -->
            <div class="step" id="step3">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Les valeurs de votre entreprise</div>
                    <div class="step-subtitle">
                        Identifiez les 5 valeurs qui définissent le mieux votre organisation (choisissez parmi les options)
                    </div>
                </div>

                <div class="value-grid">
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🎯 Excellence</h4>
                        <p>Qualité irréprochable dans tous nos services</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🚀 Innovation</h4>
                        <p>Pionnier dans notre secteur d'activité</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🤝 Collaboration</h4>
                        <p>Partenariats durables et équipe unie</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🔒 Intégrité</h4>
                        <p>Transparence et éthique en toute circonstance</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>👥 Centré client</h4>
                        <p>Satisfaction client au cœur de nos décisions</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🌱 Durabilité</h4>
                        <p>Responsabilité environnementale et sociale</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>⚡ Agilité</h4>
                        <p>Adaptation rapide aux changements du marché</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>📈 Performance</h4>
                        <p>Résultats mesurables et amélioration continue</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🎓 Expertise</h4>
                        <p>Compétence reconnue et savoir-faire unique</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🌍 Impact positif</h4>
                        <p>Contribution bénéfique à la société</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🔧 Simplicité</h4>
                        <p>Solutions simples et accessibles</p>
                    </div>
                    <div class="value-card" onclick="toggleValue(this)">
                        <h4>🏆 Leadership</h4>
                        <p>Référence dans notre domaine d'activité</p>
                    </div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <strong>💡 Conseil :</strong> Sélectionnez exactement 5 valeurs qui résonnent le plus avec vous. 
                    <span id="valueCount" style="font-weight: bold; color: #667eea;">0/5 sélectionnées</span>
                </div>
            </div>

            <!-- Étape 4: Impact désiré -->
            <div class="step" id="step4">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">L'impact de votre entreprise</div>
                    <div class="step-subtitle">
                        Comment votre entreprise transforme-t-elle le marché et la société ?
                    </div>
                </div>

                <div class="question-card">
                    <div class="question">🌟 Dans un monde idéal où votre entreprise aurait pleinement réussi, qu'est-ce qui aurait changé dans votre secteur ?</div>
                    <textarea class="answer-input" id="q4_1" placeholder="Décrivez les transformations que votre entreprise aimerait apporter à l'industrie..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">🎯 Qui sont vos clients idéaux et quel est leur principal défi que vous résolvez ?</div>
                    <textarea class="answer-input" id="q4_2" placeholder="Votre cible prioritaire et le problème majeur que vous leur résolvez..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">💡 Quelle différence unique votre entreprise fait-elle dans la vie de vos clients ?</div>
                    <textarea class="answer-input" id="q4_3" placeholder="La transformation concrète que vos clients vivent grâce à vous..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">📊 Dans 10 ans, à quoi ressemblerait le succès de votre entreprise ?</div>
                    <textarea class="answer-input" id="q4_4" placeholder="Votre vision du succès : impact, taille, reconnaissance, héritage..."></textarea>
                </div>
            </div>

            <!-- Étape 5: Votre unicité -->
            <div class="step" id="step5">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">L'unicité de votre entreprise</div>
                    <div class="step-subtitle">
                        Qu'est-ce qui rend votre entreprise unique sur le marché ?
                    </div>
                </div>

                <div class="question-card">
                    <div class="question">⭐ Quels sont les "super-pouvoirs" de votre entreprise ? Dans quoi excellez-vous naturellement ?</div>
                    <textarea class="answer-input" id="q5_1" placeholder="Vos compétences clés, savoir-faire uniques, forces distinctives..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">🎨 Quelle est l'approche particulière de votre entreprise pour servir ses clients ?</div>
                    <textarea class="answer-input" id="q5_2" placeholder="Votre méthode, processus, philosophie de service..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">💎 Qu'est-ce qui différencie vraiment votre entreprise de vos concurrents ?</div>
                    <textarea class="answer-input" id="q5_3" placeholder="Votre avantage concurrentiel durable, votre signature unique..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">🌈 Quelle est la vision de votre entreprise pour transformer votre industrie ?</div>
                    <textarea class="answer-input" id="q5_4" placeholder="Votre vision inspirante du futur de votre secteur..."></textarea>
                </div>
            </div>

            <!-- Étape 6: Émotions et passion -->
            <div class="step" id="step6">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">L'émotion qui anime votre entreprise</div>
                    <div class="step-subtitle">
                        Votre Why d'entreprise doit émouvoir. Quelle émotion souhaitez-vous transmettre à vos clients ?
                    </div>
                </div>

                <div class="emotion-selector">
                    <div class="emotion-card" onclick="selectEmotion(this, 'espoir')">
                        <div class="emotion-icon">🌅</div>
                        <h4>Espoir</h4>
                        <p>Optimisme et foi en l'avenir</p>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion(this, 'determination')">
                        <div class="emotion-icon">💪</div>
                        <h4>Détermination</h4>
                        <p>Force et persévérance</p>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion(this, 'compassion')">
                        <div class="emotion-icon">❤️</div>
                        <h4>Compassion</h4>
                        <p>Empathie et bienveillance</p>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion(this, 'inspiration')">
                        <div class="emotion-icon">✨</div>
                        <h4>Inspiration</h4>
                        <p>Motivation et créativité</p>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion(this, 'urgence')">
                        <div class="emotion-icon">⚡</div>
                        <h4>Urgence</h4>
                        <p>Nécessité d'agir rapidement</p>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion(this, 'joie')">
                        <div class="emotion-icon">😊</div>
                        <h4>Joie</h4>
                        <p>Bonheur et enthousiasme</p>
                    </div>
                </div>

                <div class="question-card" style="margin-top: 30px;">
                    <div class="question">🔥 Complétez cette phrase : "Ce qui passionne notre équipe le plus, c'est..."</div>
                    <textarea class="answer-input" id="q6_1" placeholder="Exprimez la passion collective de votre entreprise en une phrase..."></textarea>
                </div>

                <div class="question-card">
                    <div class="question">💫 Si vous deviez convaincre un prospect en 30 secondes de choisir votre entreprise, que diriez-vous ?</div>
                    <textarea class="answer-input" id="q6_2" placeholder="Votre elevator pitch d'entreprise émotionnel..."></textarea>
                </div>
            </div>

            <!-- Étape 7: Résultat -->
            <div class="step" id="step7">
                <div class="step-header">
                    <div class="step-number">🎉</div>
                    <div class="step-title">Le Why de votre Entreprise</div>
                    <div class="step-subtitle">
                        Félicitations ! Voici la raison d'être de votre organisation synthétisée
                    </div>
                </div>

                <div class="why-result">
                    <div class="why-statement" id="finalWhy">
                        "Nous analysons vos réponses pour générer le Why de votre entreprise..."
                    </div>

                    <div class="why-breakdown">
                        <div class="breakdown-card">
                            <div class="breakdown-title">🎯 Notre Mission</div>
                            <div id="missionText">La mission de votre entreprise sera générée ici...</div>
                        </div>
                        <div class="breakdown-card">
                            <div class="breakdown-title">💎 Nos Valeurs Clés</div>
                            <div id="valuesText">Les valeurs de votre entreprise seront listées ici...</div>
                        </div>
                        <div class="breakdown-card">
                            <div class="breakdown-title">🌟 Notre Impact</div>
                            <div id="impactText">L'impact de votre entreprise sera décrit ici...</div>
                        </div>
                    </div>

                    <div class="tips-section">
                        <div class="tips-title">🚀 Comment utiliser le Why de votre entreprise</div>
                        <div class="tip-item">
                            <strong>Communication externe :</strong> Intégrez votre Why dans tous vos supports marketing et commerciaux
                        </div>
                        <div class="tip-item">
                            <strong>Alignement d'équipe :</strong> Utilisez votre Why pour recruter, former et motiver vos collaborateurs
                        </div>
                        <div class="tip-item">
                            <strong>Prise de décision :</strong> Votre Why devient la boussole pour toutes vos décisions stratégiques
                        </div>
                        <div class="tip-item">
                            <strong>Différenciation marché :</strong> Votre Why vous distingue de la concurrence sur des critères émotionnels
                        </div>
                    </div>

                    <div class="inspiration-quotes">
                        <div class="quote">
                            "Les gens n'achètent pas ce que vous faites, ils achètent pourquoi vous le faites" - Simon Sinek
                        </div>
                        <div class="quote">
                            "Une entreprise avec un Why fort attire des employés et clients passionnés" - Seth Godin
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <button class="btn" onclick="downloadWhyPDF()">📄 Télécharger mon Why en PDF</button>
                        <button class="btn btn-secondary" onclick="shareWhy()">📤 Partager mon Why</button>
                        <button class="btn" onclick="showAiEnhancement()" style="background: #17a2b8;">🤖 Améliorer avec IA</button>
                        <button class="btn" onclick="restartJourney()" style="background: #28a745;">🔄 Refaire le parcours</button>
                    </div>
                </div>
            </div>

            <!-- Modal IA Enhancement -->
            <div id="aiModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>🤖 Amélioration IA de votre Why</h2>
                        <span class="close" onclick="closeAiModal()">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div id="aiConfig" class="config-section">
                            <h3>Configuration</h3>
                            <div class="form-group">
                                <label for="apiKey">Clé API:</label>
                                <input type="password" id="apiKey" placeholder="Entrez votre clé API OpenAI ou Anthropic">
                                <small>Votre clé n'est pas stockée et reste privée</small>
                            </div>
                            <div class="form-group">
                                <label for="aiProvider">Fournisseur:</label>
                                <select id="aiProvider">
                                    <option value="openai">OpenAI (GPT-4)</option>
                                    <option value="anthropic">Anthropic (Claude)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="enhancementStyle">Style d'amélioration:</label>
                                <select id="enhancementStyle">
                                    <option value="professional">Professionnel et impactant</option>
                                    <option value="inspirational">Inspirant et émotionnel</option>
                                    <option value="concise">Concis et percutant</option>
                                    <option value="storytelling">Narratif et engageant</option>
                                </select>
                            </div>
                            <button class="btn" onclick="generateAiVersions()">🚀 Générer les versions</button>
                        </div>
                        
                        <div id="aiResults" class="results-section" style="display: none;">
                            <h3>Versions générées par IA</h3>
                            <div id="aiVersions"></div>
                            <div style="margin-top: 20px;">
                                <button class="btn btn-secondary" onclick="backToConfig()">← Retour</button>
                            </div>
                        </div>
                        
                        <div id="aiLoading" class="loading-section" style="display: none;">
                            <div class="loading-spinner"></div>
                            <p>Génération de vos versions améliorées en cours...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousStep()" disabled>← Précédent</button>
                <button class="btn" id="nextBtn" onclick="nextStep()">Suivant →</button>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentStep = 1;
        const totalSteps = 7;
        let selectedValues = [];
        let selectedEmotion = '';
        let userResponses = {};

        // Navigation entre étapes
        function nextStep() {
            if (currentStep < totalSteps) {
                // Sauvegarder les réponses de l'étape actuelle
                saveCurrentStepData();
                
                // Validation spécifique par étape
                if (!validateCurrentStep()) {
                    return;
                }

                // Passer à l'étape suivante
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep++;
                document.getElementById(`step${currentStep}`).classList.add('active');
                
                // Si on arrive à la dernière étape, générer le Why
                if (currentStep === 7) {
                    generateWhy();
                }
                
                updateProgress();
                updateNavigation();
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                document.getElementById(`step${currentStep}`).classList.remove('active');
                currentStep--;
                document.getElementById(`step${currentStep}`).classList.add('active');
                updateProgress();
                updateNavigation();
            }
        }

        function updateProgress() {
            const progress = ((currentStep - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Mettre à jour les indicateurs d'étapes
            const dots = document.querySelectorAll('.step-dot');
            dots.forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    dot.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    dot.classList.add('active');
                }
            });
        }

        function updateNavigation() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentStep === 1;
            
            if (currentStep === totalSteps) {
                nextBtn.style.display = 'none';
            } else {
                nextBtn.style.display = 'block';
                nextBtn.textContent = currentStep === totalSteps - 1 ? 'Générer mon Why →' : 'Suivant →';
            }
        }

        // Gestion des valeurs
        function toggleValue(element) {
            const isSelected = element.classList.contains('selected');
            const valueName = element.querySelector('h4').textContent;
            
            if (isSelected) {
                // Désélectionner
                element.classList.remove('selected');
                selectedValues = selectedValues.filter(v => v !== valueName);
            } else {
                // Vérifier la limite de 5
                if (selectedValues.length >= 5) {
                    alert('⚠️ Vous pouvez sélectionner maximum 5 valeurs. Désélectionnez-en une d\'abord.');
                    return;
                }
                // Sélectionner
                element.classList.add('selected');
                selectedValues.push(valueName);
            }
            
            updateValueCount();
        }

        function updateValueCount() {
            document.getElementById('valueCount').textContent = `${selectedValues.length}/5 sélectionnées`;
        }

        // Gestion des émotions
        function selectEmotion(element, emotion) {
            // Désélectionner toutes les autres émotions
            document.querySelectorAll('.emotion-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Sélectionner l'émotion cliquée
            element.classList.add('selected');
            selectedEmotion = emotion;
        }

        // Sauvegarde des données
        function saveCurrentStepData() {
            switch(currentStep) {
                case 2:
                    userResponses.motivations = {
                        moment_vivant: document.getElementById('q2_1').value,
                        colere: document.getElementById('q2_2').value,
                        compliment: document.getElementById('q2_3').value,
                        vie_ideale: document.getElementById('q2_4').value
                    };
                    break;
                case 3:
                    userResponses.values = selectedValues;
                    break;
                case 4:
                    userResponses.impact = {
                        monde_ideal: document.getElementById('q4_1').value,
                        qui_aider: document.getElementById('q4_2').value,
                        probleme_resoudre: document.getElementById('q4_3').value,
                        mesure_succes: document.getElementById('q4_4').value
                    };
                    break;
                case 5:
                    userResponses.unicite = {
                        super_pouvoirs: document.getElementById('q5_1').value,
                        approche: document.getElementById('q5_2').value,
                        differentiation: document.getElementById('q5_3').value,
                        vision: document.getElementById('q5_4').value
                    };
                    break;
                case 6:
                    userResponses.emotion = {
                        emotion_principale: selectedEmotion,
                        passion: document.getElementById('q6_1').value,
                        elevator_pitch: document.getElementById('q6_2').value
                    };
                    break;
            }
        }

        // Validation des étapes
        function validateCurrentStep() {
            switch(currentStep) {
                case 2:
                    const motivationFields = ['q2_1', 'q2_2', 'q2_3', 'q2_4'];
                    const filledMotivations = motivationFields.filter(id => 
                        document.getElementById(id).value.trim() !== ''
                    );
                    if (filledMotivations.length < 3) {
                        alert('⚠️ Veuillez répondre à au moins 3 questions sur 4 pour continuer.');
                        return false;
                    }
                    break;
                case 3:
                    if (selectedValues.length < 3) {
                        alert('⚠️ Veuillez sélectionner au moins 3 valeurs pour continuer.');
                        return false;
                    }
                    break;
                case 4:
                    const impactFields = ['q4_1', 'q4_2', 'q4_3'];
                    const filledImpact = impactFields.filter(id => 
                        document.getElementById(id).value.trim() !== ''
                    );
                    if (filledImpact.length < 2) {
                        alert('⚠️ Veuillez répondre à au moins 2 questions sur l\'impact pour continuer.');
                        return false;
                    }
                    break;
                case 5:
                    const uniciteFields = ['q5_1', 'q5_2', 'q5_3'];
                    const filledUnicite = uniciteFields.filter(id => 
                        document.getElementById(id).value.trim() !== ''
                    );
                    if (filledUnicite.length < 2) {
                        alert('⚠️ Veuillez répondre à au moins 2 questions sur votre unicité pour continuer.');
                        return false;
                    }
                    break;
                case 6:
                    if (!selectedEmotion) {
                        alert('⚠️ Veuillez sélectionner une émotion principale.');
                        return false;
                    }
                    if (!document.getElementById('q6_1').value.trim()) {
                        alert('⚠️ Veuillez compléter la phrase sur votre passion.');
                        return false;
                    }
                    break;
            }
            return true;
        }

        // Génération du Why
        function generateWhy() {
            // Simuler un délai de traitement
            document.getElementById('finalWhy').innerHTML = '🤖 Analyse de vos réponses en cours...';
            
            setTimeout(() => {
                const why = constructWhy();
                document.getElementById('finalWhy').innerHTML = why.statement;
                document.getElementById('missionText').innerHTML = why.mission;
                document.getElementById('valuesText').innerHTML = why.values;
                document.getElementById('impactText').innerHTML = why.impact;
            }, 2000);
        }

        function constructWhy() {
            // Analyser les réponses pour construire un Why personnalisé
            const responses = userResponses;
            
            // Construire la déclaration principale
            let statement = "Notre raison d'être est de ";
            
            // Utiliser l'impact désiré comme base
            if (responses.impact && responses.impact.probleme_resoudre) {
                statement += responses.impact.probleme_resoudre.toLowerCase();
            }
            
            statement += " pour ";
            
            // Ajouter le public cible
            if (responses.impact && responses.impact.qui_aider) {
                statement += responses.impact.qui_aider.toLowerCase();
            }
            
            statement += ", en utilisant ";
            
            // Ajouter l'approche unique
            if (responses.unicite && responses.unicite.super_pouvoirs) {
                statement += responses.unicite.super_pouvoirs.toLowerCase();
            }
            
            statement += ", parce que nous croyons fermement que ";
            
            // Ajouter la vision
            if (responses.unicite && responses.unicite.vision) {
                statement += responses.unicite.vision.toLowerCase();
            }
            
            // Construire la mission
            let mission = "Transformer la façon dont ";
            if (responses.impact && responses.impact.qui_aider) {
                mission += responses.impact.qui_aider.toLowerCase();
            }
            mission += " abordent leurs défis quotidiens.";
            
            // Construire les valeurs
            let values = "";
            if (responses.values && responses.values.length > 0) {
                values = responses.values.join(" • ");
            }
            
            // Construire l'impact
            let impact = "";
            if (responses.impact && responses.impact.monde_ideal) {
                impact = responses.impact.monde_ideal;
            }
            
            return {
                statement: statement,
                mission: mission,
                values: values,
                impact: impact
            };
        }

        // Fonction pour encoder correctement les caractères UTF-8 pour jsPDF
        function cleanTextForPDF(text) {
            if (!text) return '';
            // Simplement retourner le texte tel quel - jsPDF moderne gère l'UTF-8
            return text.toString();
        }

        // Génération PDF
        function downloadWhyPDF() {
            // Vérifier que jsPDF est disponible
            if (typeof window.jspdf === 'undefined' && typeof jsPDF === 'undefined') {
                alert('❌ Erreur : jsPDF non disponible');
                return;
            }
            
            // Essayer d'accéder à jsPDF via différentes méthodes
            let jsPDFClass;
            if (typeof jsPDF !== 'undefined') {
                jsPDFClass = jsPDF; // Accès direct global
            } else if (window.jspdf && window.jspdf.jsPDF) {
                jsPDFClass = window.jspdf.jsPDF; // Accès via namespace
            } else {
                alert('❌ Impossible d\'accéder à jsPDF');
                return;
            }
            
            const doc = new jsPDFClass({
                orientation: 'portrait',
                unit: 'mm',
                format: 'a4'
            });
            
            // Configuration optimisée pour une seule page
            const margin = 15;
            let y = margin;
            const pageWidth = doc.internal.pageSize.width;
            const pageHeight = doc.internal.pageSize.height;
            
            // Couleurs
            const primaryColor = [102, 126, 234];
            const secondaryColor = [118, 75, 162];
            const textColor = [45, 55, 72];
            const lightGray = [248, 249, 250];
            
            // En-tête compact
            doc.setFillColor(...primaryColor);
            doc.rect(0, 0, pageWidth, 35, 'F');
            
            // Titre principal
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.text('MON WHY PERSONNEL', margin, 18);
            
            doc.setFontSize(10);
            doc.text('Raison d\'être et mission de vie - ' + new Date().toLocaleDateString('fr-FR'), margin, 28);
            
            y = 45;
            
            // Section Why principal - compact
            doc.setFillColor(...lightGray);
            doc.rect(margin, y, pageWidth - 2*margin, 30, 'F');
            doc.setDrawColor(...primaryColor);
            doc.setLineWidth(1);
            doc.rect(margin, y, pageWidth - 2*margin, 30, 'S');
            
            doc.setTextColor(...textColor);
            doc.setFontSize(12);
            doc.text('MON WHY', margin + 5, y + 8);
            
            doc.setFontSize(9);
            const whyText = cleanTextForPDF(document.getElementById('finalWhy').textContent);
            const whyLines = doc.splitTextToSize(whyText, pageWidth - 2*margin - 10);
            doc.text(whyLines.slice(0, 3), margin + 5, y + 16); // Limite à 3 lignes
            
            y += 40;
            
            // Layout en 2 colonnes pour optimiser l'espace
            const colWidth = (pageWidth - 3*margin) / 2;
            const col1X = margin;
            const col2X = margin + colWidth + margin;
            
            // Colonne 1 - Mission et Valeurs
            let col1Y = y;
            doc.setFontSize(11);
            doc.setTextColor(...primaryColor);
            doc.text('MA MISSION', col1X, col1Y);
            
            col1Y += 8;
            doc.setFontSize(8);
            doc.setTextColor(...textColor);
            const missionText = cleanTextForPDF(document.getElementById('missionText').textContent);
            const missionLines = doc.splitTextToSize(missionText, colWidth);
            doc.text(missionLines.slice(0, 4), col1X, col1Y); // Limite à 4 lignes
            
            col1Y += (Math.min(missionLines.length, 4) * 4) + 12;
            
            // Valeurs dans la colonne 1
            doc.setFontSize(11);
            doc.setTextColor(...primaryColor);
            doc.text('MES VALEURS', col1X, col1Y);
            
            col1Y += 8;
            doc.setFontSize(8);
            doc.setTextColor(...textColor);
            const valuesText = cleanTextForPDF(document.getElementById('valuesText').textContent);
            const valuesArray = valuesText.split(' • ');
            valuesArray.slice(0, 5).forEach((value, index) => {
                if (value.trim()) {
                    doc.text(`• ${cleanTextForPDF(value.trim())}`, col1X, col1Y + (index * 4));
                }
            });
            
            // Colonne 2 - Impact et Réponses clés
            let col2Y = y;
            doc.setFontSize(11);
            doc.setTextColor(...primaryColor);
            doc.text('MON IMPACT', col2X, col2Y);
            
            col2Y += 8;
            doc.setFontSize(8);
            doc.setTextColor(...textColor);
            const impactText = cleanTextForPDF(document.getElementById('impactText').textContent);
            const impactLines = doc.splitTextToSize(impactText, colWidth);
            doc.text(impactLines.slice(0, 4), col2X, col2Y); // Limite à 4 lignes
            
            col2Y += (Math.min(impactLines.length, 4) * 4) + 12;
            
            // Points clés dans la colonne 2
            doc.setFontSize(11);
            doc.setTextColor(...primaryColor);
            doc.text('POINTS CLES', col2X, col2Y);
            
            col2Y += 8;
            doc.setFontSize(7);
            doc.setTextColor(...textColor);
            
            const keyPoints = [
                { label: 'Passion', value: userResponses.emotion?.passion || '' },
                { label: 'Super-pouvoir', value: userResponses.unicite?.super_pouvoirs || '' },
                { label: 'Vision', value: userResponses.unicite?.vision || '' }
            ];
            
            keyPoints.forEach((item, index) => {
                if (item.value && col2Y < pageHeight - 40) {
                    doc.setFontSize(8);
                    doc.setTextColor(...primaryColor);
                    doc.text(item.label + ':', col2X, col2Y);
                    
                    col2Y += 4;
                    doc.setFontSize(7);
                    doc.setTextColor(...textColor);
                    const shortValue = cleanTextForPDF(item.value.substring(0, 120) + '...');
                    const valueLines = doc.splitTextToSize(shortValue, colWidth);
                    doc.text(valueLines.slice(0, 2), col2X, col2Y); // Max 2 lignes par point
                    
                    col2Y += (Math.min(valueLines.length, 2) * 3) + 6;
                }
            });
            
            // Footer compact
            const footerY = pageHeight - 12;
            doc.setFillColor(...primaryColor);
            doc.rect(0, footerY - 3, pageWidth, 15, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(7);
            doc.text('Générateur de Why - Découvrez votre raison d\'être', margin, footerY);
            doc.text('www.votre-site.com', pageWidth - margin - 35, footerY);
            
            // Sauvegarder
            const fileName = `mon-why-${new Date().toISOString().split('T')[0]}.pdf`;
            doc.save(fileName);
            
            alert(`✅ PDF généré avec succès : ${fileName}`);
        }

        function shareWhy() {
            if (navigator.share) {
                navigator.share({
                    title: 'Mon Why Personnel',
                    text: document.getElementById('finalWhy').textContent,
                    url: window.location.href
                });
            } else {
                // Fallback pour les navigateurs qui ne supportent pas Web Share API
                const text = document.getElementById('finalWhy').textContent;
                navigator.clipboard.writeText(text).then(() => {
                    alert('✅ Votre Why a été copié dans le presse-papiers !');
                });
            }
        }

        function restartJourney() {
            if (confirm('Êtes-vous sûr de vouloir recommencer le parcours ? Toutes vos réponses seront perdues.')) {
                currentStep = 1;
                selectedValues = [];
                selectedEmotion = '';
                userResponses = {};
                
                // Réinitialiser l'interface
                document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
                document.getElementById('step1').classList.add('active');
                
                document.querySelectorAll('.answer-input').forEach(input => input.value = '');
                document.querySelectorAll('.value-card.selected').forEach(card => card.classList.remove('selected'));
                document.querySelectorAll('.emotion-card.selected').forEach(card => card.classList.remove('selected'));
                
                updateProgress();
                updateNavigation();
                updateValueCount();
            }
        }

        // Fonction pour charger des données de test
        function loadTestData() {
            if (confirm('Cette action va charger des données de test et vous amener directement au résultat. Continuer ?')) {
                // Réinitialiser d'abord
                currentStep = 1;
                selectedValues = [];
                selectedEmotion = '';
                userResponses = {};
                
                // Données de test réalistes pour entreprise
                // Étape 2: Origines de l'entreprise
                document.getElementById('q2_1').value = "Nous avons créé notre entreprise en constatant que les PME perdaient un temps énorme avec des outils numériques complexes et peu intuitifs. Nous voulions leur redonner du temps pour se concentrer sur leur cœur de métier.";
                document.getElementById('q2_2').value = "La complexité artificielle des solutions logicielles. Trop d'entreprises se battent avec des outils qui devraient les aider, pas les ralentir.";
                document.getElementById('q2_3').value = "Un dirigeant nous a dit : 'Grâce à vous, je peux enfin me concentrer sur mes clients au lieu de lutter contre mes outils'. Cette simplicité retrouvée, c'est notre fierté.";
                document.getElementById('q2_4').value = "Créer un écosystème où chaque PME aurait accès à des outils aussi puissants que les grandes entreprises, mais avec la simplicité d'un smartphone.";
                
                // Étape 3: Valeurs d'entreprise (sélectionner 5 valeurs)
                selectedValues = ['🎯 Excellence', '🔧 Simplicité', '🚀 Innovation', '👥 Centré client', '⚡ Agilité'];
                
                // Mettre à jour l'affichage des valeurs
                document.querySelectorAll('.value-card').forEach(card => {
                    const valueName = card.querySelector('h4').textContent;
                    if (selectedValues.includes(valueName)) {
                        card.classList.add('selected');
                    }
                });
                
                // Étape 4: Impact sur le marché
                document.getElementById('q4_1').value = "Un secteur où la technologie sert vraiment les entreprises au lieu de les compliquer. Où chaque PME peut rivaliser avec les grandes entreprises grâce à des outils intuitifs.";
                document.getElementById('q4_2').value = "Les dirigeants de PME qui croulent sous la complexité technique et n'arrivent plus à se concentrer sur leur métier et leurs clients.";
                document.getElementById('q4_3').value = "Nous transformons des journées de frustration en minutes de productivité. Nos clients retrouvent le plaisir de diriger leur entreprise.";
                document.getElementById('q4_4').value = "Être la référence en simplicité d'usage, avoir accompagné 10 000 PME vers leur transformation numérique et être reconnus pour notre impact sur l'économie locale.";
                
                // Étape 5: Unicité de l'entreprise
                document.getElementById('q5_1').value = "Notre capacité unique à transformer la complexité en simplicité. Nous maîtrisons la technique pour mieux la faire oublier.";
                document.getElementById('q5_2').value = "Nous commençons toujours par comprendre le métier de nos clients avant de proposer une solution technique. L'humain avant la technologie.";
                document.getElementById('q5_3').value = "Pendant que nos concurrents ajoutent des fonctionnalités, nous en retirons. Notre force c'est dire non à la complexité inutile.";
                document.getElementById('q5_4').value = "Un futur où la technologie est invisible et intuitive, où les outils numériques sont aussi simples que les objets du quotidien.";
                
                // Étape 6: Émotion et passion
                selectedEmotion = 'inspiration';
                document.querySelectorAll('.emotion-card').forEach(card => {
                    if (card.onclick.toString().includes('inspiration')) {
                        card.classList.add('selected');
                    }
                });
                
                document.getElementById('q6_1').value = "Ce qui passionne notre équipe le plus, c'est voir un dirigeant retrouver le sourire quand il réalise que son outil de travail devient enfin son allié.";
                document.getElementById('q6_2').value = "Et si votre technologie devenait aussi simple que votre café du matin ? Nous transformons la complexité numérique en simplicité quotidienne. Prêt à retrouver le plaisir de diriger ?";
                
                // Sauvegarder toutes les données
                userResponses = {
                    motivations: {
                        moment_vivant: document.getElementById('q2_1').value,
                        colere: document.getElementById('q2_2').value,
                        compliment: document.getElementById('q2_3').value,
                        vie_ideale: document.getElementById('q2_4').value
                    },
                    values: selectedValues,
                    impact: {
                        monde_ideal: document.getElementById('q4_1').value,
                        qui_aider: document.getElementById('q4_2').value,
                        probleme_resoudre: document.getElementById('q4_3').value,
                        mesure_succes: document.getElementById('q4_4').value
                    },
                    unicite: {
                        super_pouvoirs: document.getElementById('q5_1').value,
                        approche: document.getElementById('q5_2').value,
                        differentiation: document.getElementById('q5_3').value,
                        vision: document.getElementById('q5_4').value
                    },
                    emotion: {
                        emotion_principale: selectedEmotion,
                        passion: document.getElementById('q6_1').value,
                        elevator_pitch: document.getElementById('q6_2').value
                    }
                };
                
                // Aller directement à l'étape 7 (résultat)
                document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
                currentStep = 7;
                document.getElementById('step7').classList.add('active');
                
                updateProgress();
                updateNavigation();
                updateValueCount();
                
                // Générer le Why avec les données de test
                generateWhy();
                
                // Notifier l'utilisateur
                setTimeout(() => {
                    alert('✅ Données de test chargées ! Vous pouvez maintenant explorer le résultat et tester les fonctionnalités.');
                }, 3000);
            }
        }

        // Fonctions IA Enhancement
        function showAiEnhancement() {
            document.getElementById('aiModal').style.display = 'block';
            document.getElementById('aiConfig').style.display = 'block';
            document.getElementById('aiResults').style.display = 'none';
            document.getElementById('aiLoading').style.display = 'none';
        }

        function closeAiModal() {
            document.getElementById('aiModal').style.display = 'none';
        }

        function backToConfig() {
            document.getElementById('aiConfig').style.display = 'block';
            document.getElementById('aiResults').style.display = 'none';
        }

        async function generateAiVersions() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const provider = document.getElementById('aiProvider').value;
            const style = document.getElementById('enhancementStyle').value;

            if (!apiKey) {
                alert('⚠️ Veuillez entrer votre clé API');
                return;
            }

            // Afficher le loading
            document.getElementById('aiConfig').style.display = 'none';
            document.getElementById('aiLoading').style.display = 'block';

            try {
                const currentWhy = document.getElementById('finalWhy').textContent;
                const responses = userResponses;
                
                // Préparer le prompt pour l'IA
                const prompt = createEnhancementPrompt(currentWhy, responses, style);
                
                // Appeler l'API IA
                const versions = await callAiApi(provider, apiKey, prompt);
                
                // Afficher les résultats
                displayAiVersions(versions);
                
            } catch (error) {
                console.error('Erreur IA:', error);
                alert('❌ Erreur lors de la génération: ' + error.message);
                backToConfig();
            }
        }

        function createEnhancementPrompt(currentWhy, responses, style) {
            const styleInstructions = {
                professional: "un style corporate et impactant, adapté aux communications d'entreprise",
                inspirational: "un style inspirant et émotionnel qui mobilise les équipes et séduit les clients",
                concise: "un style concis et percutant, parfait pour des pitchs et présentations",
                storytelling: "un style narratif et engageant qui raconte l'histoire de l'entreprise"
            };

            return `Tu es un expert en stratégie d'entreprise et en communication corporate, spécialisé dans la méthode "Why" de Simon Sinek pour les organisations.

Je veux que tu améliores la déclaration "Why" d'entreprise suivante avec ${styleInstructions[style]}.

Why d'entreprise actuel:
"${currentWhy}"

Contexte des réponses de l'entreprise:
- Passion collective: ${responses.emotion?.passion || 'Non spécifiée'}
- Valeurs d'entreprise: ${responses.values?.join(', ') || 'Non spécifiées'}
- Impact sur le marché: ${responses.impact?.monde_ideal || 'Non spécifié'}
- Avantages concurrentiels: ${responses.unicite?.super_pouvoirs || 'Non spécifié'}
- Vision d'entreprise: ${responses.unicite?.vision || 'Non spécifiée'}

Génère exactement 3 versions améliorées du Why d'entreprise, chacune avec une approche légèrement différente mais dans le même style demandé. Les versions doivent être adaptées pour:
- Communication externe (clients, prospects, partenaires)
- Alignement interne (équipes, recrutement)
- Positionnement concurrentiel

Format de réponse souhaité (JSON):
{
  "versions": [
    {
      "title": "Version 1 - [Titre descriptif]",
      "why": "[Déclaration Why d'entreprise améliorée]",
      "explanation": "[Courte explication de l'amélioration apportée]"
    },
    {
      "title": "Version 2 - [Titre descriptif]", 
      "why": "[Déclaration Why d'entreprise améliorée]",
      "explanation": "[Courte explication de l'amélioration apportée]"
    },
    {
      "title": "Version 3 - [Titre descriptif]",
      "why": "[Déclaration Why d'entreprise améliorée]", 
      "explanation": "[Courte explication de l'amélioration apportée]"
    }
  ]
}

Réponds uniquement avec le JSON, sans texte supplémentaire.`;
        }

        async function callAiApi(provider, apiKey, prompt) {
            let url, headers, body;

            if (provider === 'openai') {
                url = 'https://api.openai.com/v1/chat/completions';
                headers = {
                    'Authorization': `Bearer ${apiKey}`,
                    'Content-Type': 'application/json'
                };
                body = {
                    model: 'gpt-4o-mini',
                    messages: [{ role: 'user', content: prompt }],
                    temperature: 0.7
                };
            } else if (provider === 'anthropic') {
                url = 'https://api.anthropic.com/v1/messages';
                headers = {
                    'x-api-key': apiKey,
                    'Content-Type': 'application/json',
                    'anthropic-version': '2023-06-01'
                };
                body = {
                    model: 'claude-3-sonnet-20240229',
                    max_tokens: 2000,
                    messages: [{ role: 'user', content: prompt }]
                };
            }

            const response = await fetch(url, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(body)
            });

            if (!response.ok) {
                throw new Error(`Erreur API (${response.status}): ${response.statusText}`);
            }

            const data = await response.json();
            
            let content;
            if (provider === 'openai') {
                content = data.choices[0].message.content;
            } else if (provider === 'anthropic') {
                content = data.content[0].text;
            }

            try {
                return JSON.parse(content);
            } catch (parseError) {
                // Si le JSON n'est pas valide, créer un format de secours
                return {
                    versions: [
                        {
                            title: "Version Générée par IA",
                            why: content.substring(0, 500),
                            explanation: "Version générée automatiquement"
                        }
                    ]
                };
            }
        }

        function displayAiVersions(versionsData) {
            const versionsContainer = document.getElementById('aiVersions');
            versionsContainer.innerHTML = '';

            versionsData.versions.forEach((version, index) => {
                const versionCard = document.createElement('div');
                versionCard.className = 'version-card';
                versionCard.innerHTML = `
                    <h4>✨ ${version.title}</h4>
                    <div class="why-text">"${version.why}"</div>
                    <div style="font-size: 0.9rem; color: #6c757d; margin-bottom: 15px;">
                        ${version.explanation}
                    </div>
                    <div class="version-actions">
                        <button class="btn btn-small" onclick="adoptVersion(${index}, '${version.why.replace(/'/g, "\\'")}')">
                            ✅ Adopter cette version
                        </button>
                        <button class="btn btn-secondary btn-small" onclick="copyVersion('${version.why.replace(/'/g, "\\'")}')">
                            📋 Copier
                        </button>
                    </div>
                `;
                versionsContainer.appendChild(versionCard);
            });

            // Afficher les résultats
            document.getElementById('aiLoading').style.display = 'none';
            document.getElementById('aiResults').style.display = 'block';
        }

        function adoptVersion(index, whyText) {
            if (confirm('Voulez-vous remplacer votre Why actuel par cette version améliorée ?')) {
                document.getElementById('finalWhy').textContent = whyText;
                closeAiModal();
                alert('✅ Votre Why a été mis à jour avec la version sélectionnée !');
            }
        }

        function copyVersion(whyText) {
            navigator.clipboard.writeText(whyText).then(() => {
                alert('📋 Version copiée dans le presse-papiers !');
            }).catch(err => {
                console.error('Erreur copie:', err);
            });
        }

        // Fermer le modal en cliquant à l'extérieur
        window.onclick = function(event) {
            const modal = document.getElementById('aiModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            updateNavigation();
            updateValueCount();
        });
    </script>
</body>
</html>